(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e3ccd112"],{"017c":function(t,e,a){},"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"3da2":function(t,e,a){"use strict";a("ae39")},"841c":function(t,e,a){"use strict";var i=a("d784"),s=a("825a"),n=a("1d80"),o=a("129f"),r=a("14c3");i("search",1,(function(t,e,a){return[function(e){var a=n(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,a):new RegExp(e)[t](String(a))},function(t){var i=a(e,t,this);if(i.done)return i.value;var n=s(t),l=String(this),c=n.lastIndex;o(c,0)||(n.lastIndex=0);var p=r(n,l);return o(n.lastIndex,c)||(n.lastIndex=c),null===p?-1:p.index}]}))},"92d1":function(t,e,a){"use strict";a("017c")},ae39:function(t,e,a){},dd18:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{directives:[{name:"table-scroll",rawName:"v-table-scroll"}],attrs:{data:t.tableData,"header-cell-style":{background:"#E6EAFE",color:"#606266"}}},t._l(t.tableRows,(function(e,i){return a("el-table-column",{key:i,attrs:{type:e.type,fixed:e.fixed,width:e.width,label:e.label,prop:e.prop},scopedSlots:t._u([{key:"default",fn:function(i){return["detail"===e.prop?a("div",{staticClass:"detail-color",on:{click:t.handDetail}},[t._v(" 明细 ")]):"index"==e.type?a("div",[t._v(t._s(i.$index+1))]):a("div",[t._v(t._s(i.row[e.prop]))])]}}],null,!0)})})),1)],1)},s=[],n={name:"table2",props:{tableRows:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}}},data:function(){return{domObj:""}},created:function(){},mounted:function(){},methods:{handDetail:function(){this.$emit("handlDetail")}}},o=n,r=(a("92d1"),a("2877")),l=Object(r["a"])(o,i,s,!1,null,"2af1fdae",null);e["a"]=l.exports},e706:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"repor-cont commpage"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"common-pfc"},[t._v("电量报表")])]),a("div",{staticClass:"common-card"},[a("div",{staticClass:"common-font"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.queryForm}},[a("el-form-item",{staticClass:"max-item point-item",attrs:{label:"计量点选择:","label-width":"90px"}},[a("el-select",{attrs:{placeholder:"计量点选择"},model:{value:t.queryForm.jpcode,callback:function(e){t.$set(t.queryForm,"jpcode",e)},expression:"queryForm.jpcode"}},t._l(t.pointOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{staticClass:"min-item",attrs:{label:"数据类型:","label-width":"90px"}},[a("el-select",{attrs:{placeholder:"数据类型"},model:{value:t.queryForm.type,callback:function(e){t.$set(t.queryForm,"type",e)},expression:"queryForm.type"}},t._l(t.typeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),"pamx"!==t.queryForm.type?a("el-form-item",{staticClass:"min-item",attrs:{label:"时段选择:","label-width":"90px"}},[a("el-select",{attrs:{placeholder:"时段选择"},model:{value:t.queryForm.part,callback:function(e){t.$set(t.queryForm,"part",e)},expression:"queryForm.part"}},t._l(t.parts,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1):t._e(),a("el-form-item",{staticClass:"max-item",attrs:{label:"起止时间:","label-width":"90px"}},[a("div",[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.timeArr,callback:function(e){t.timeArr=e},expression:"timeArr"}})],1)])],1),a("div",{staticClass:"btn-box"},[a("span",{on:{click:t.reSet}},[t._v("重 置")]),a("span",{on:{click:t.search}},[t._v("查 询")])])],1),a("div",{staticClass:"reporTabs"},[a("span",{class:t.showChar?"":"checked-btn",on:{click:t.changTable}},[t._v("报 表")]),a("span",{class:t.showChar?"checked-btn":"",on:{click:t.changChar}},[t._v("图 表")]),a("span",{on:{click:t.handDown}},[t._v("下 载")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.showOne,expression:"showOne===1"}],staticClass:"desc-box"},[a("div",{staticClass:"common-pfc"},[t._v("查询区间电量明细（kW·h）")]),a("div",{staticClass:"desc-cont"},[a("div",{staticClass:"felxOne"},[t._v(" 总电量："),a("span",{staticClass:"bule common-pfc"},[t._v(t._s(t.tQ?t.tQ:0)+" ")])]),a("div",{staticClass:"felxOne"},[t._v(" 尖时段："),a("span",{staticClass:"light-bule common-pfc"},[t._v(t._s(t.jQ?t.jQ:0)+" ")])]),a("div",{staticClass:"felxOne"},[t._v(" 峰时段："),a("span",{staticClass:"violet common-pfc"},[t._v(t._s(t.fQ?t.fQ:0))])]),a("div",{staticClass:"felxOne"},[t._v(" 平时段："),a("span",{staticClass:"yellow common-pfc"},[t._v(t._s(t.pQ?t.pQ:0))])]),a("div",{staticClass:"felxOne"},[t._v(" 谷时段："),a("span",{staticClass:"red common-pfc"},[t._v(t._s(t.gQ?t.gQ:0))])])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.showOne,expression:"showOne===2"}],staticClass:"desc-box"},[a("div",{staticClass:"common-pfc"},[t._v("查询区间功率明细")]),a("div",{staticClass:"desc-cont"},[a("div",{staticClass:"felxOne"},[t._v(" 时段最大功率因数："),a("span",{staticClass:"bule common-pfc"},[t._v(t._s(t._f("toFixed_2")(t.max))+" ")])]),a("div",{staticClass:"felxOne"},[t._v(" 最小功率因数："),a("span",{staticClass:"light-bule common-pfc"},[t._v(t._s(t._f("toFixed_2")(t.min))+" ")])]),a("div",{staticClass:"felxThree"},[t._v(" 平均最大功率因数："),a("span",{staticClass:"yellow common-pfc"},[t._v(t._s(t._f("toFixed_2")(t.avg)))])])])]),a("div",{staticClass:"table-box"},[t.showChar?a("div",{staticClass:"repbarChar"},[a("LineChart",{attrs:{"class-name":"barChar","char-type":"ePtp"==t.queryForm.type?"bar":"line","chart-data":t.lineCharData}})],1):a("Table",{attrs:{"table-rows":t.tableRows,"table-data":t.tableData},on:{handlDetail:t.handlDetail}})],1),a("el-dialog",{attrs:{title:"明细",visible:t.dialogVisible,hight:"600px",width:"65%","before-close":t.handleClose,top:"20vh"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"dialogCont"},[a("div",[a("el-table",{attrs:{data:t.detailData,"header-cell-style":{background:"#E6EAFE",color:"#606266"}}},t._l(t.detailRows,(function(t){return a("el-table-column",{key:t.label,attrs:{label:t.label,prop:t.prop,type:t.type}})})),1)],1)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.exportDown}},[t._v("导 出")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showChar,expression:"!showChar"}],staticClass:"pagination-box"},[a("el-pagination",{attrs:{"current-page":t.pageNum,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:"prev, pager, next, jumper,total, sizes",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}})],1)],1)])],1)},s=[],n=(a("99af"),a("4de4"),a("d81d"),a("b0c0"),a("b680"),a("ac1f"),a("841c"),a("5530")),o=a("81ac"),r=a("2f62"),l=(a("3191"),a("f076")),c=(a("4bda"),a("3de1")),p=a("c1df"),u=a.n(p),d=a("dd18"),m={name:"repor",components:{Table:d["a"],LineChart:o["a"]},data:function(){return{queryForm:{type:"ePtp",part:"1m",st:"",et:"",jpcode:""},defulteCode:"",pageNum:1,pageSize:10,isSearch:!1,total:0,showChar:!1,jpcode:"",timeArr:"",tQ:"",jQ:"",fQ:"",pQ:"",gQ:"",typeOptions:[{label:"正向有功电量",value:"ePtp"},{label:"功率因数",value:"cos"},{label:"最大需量",value:"pamx"}],parts:[{label:"15分钟",value:"1m"},{label:"30分钟",value:"30m"},{label:"时",value:"1h"},{label:"日",value:"1d"}],pointOptions:[],allData:[],tableData:[],tableRows:[],powerHead:[{width:"90px",label:"序号",fixed:"left",type:"index"},{label:"平台",prop:"kpName"},{width:250,label:"计量点",prop:"name"},{label:"用电量(kW·h)",prop:"eptp"},{label:"起码",prop:"stQ"},{label:"止码",prop:"etQ"},{label:"倍率",prop:"dbRate"},{width:300,label:"起止码时间",prop:"time"}],factorHead:[{width:"350px",label:"序号",type:"index"},{width:500,label:"平台",prop:"kpName"},{width:500,label:"计量点",prop:"name"},{label:"功率因数",prop:"mCos"}],needHead:[{width:"350px",label:"序号",type:"index"},{width:300,label:"平台",prop:"kpName"},{width:300,label:"计量点",prop:"name"},{width:300,label:"数据时间",prop:"st"},{label:"最大需量(kw)",prop:"mDmdmax"}],coulums:[],lineCharData:{legend:[],xAxis:[],yAxis:[],series:[],colors:["#2E4AF7"],name:[],grid:{right:"5%",top:42,bottom:30,left:"5%"}},min:"",avg:"",max:"",dialogVisible:!1,detailRows:[],detailData:[],showOne:1,pickerOptions:{disabledDate:function(t){var e=new Date;return e.setDate(e.getDate()+1),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),t.getTime()>e}}}},created:function(){var t=u()(new Date).format("YYYY-MM-DD 00:00:00"),e=new Date;this.timeArr=[t,e],this.initPoints()},computed:Object(n["a"])({},Object(r["c"])({teamShortName:function(t){return t.user.teamShortName},jp_code:function(t){return t.user.jp_code},points:function(t){return t.user.points}})),mounted:function(){},watch:{points:{deep:!0,handler:function(t){this.initPoints()}}},methods:{initPoints:function(){var t=this;this.points.map((function(e){1==e.alive&&(t.queryForm.jpcode=e.code,t.defulteCode=e.code),t.pointOptions.push({label:e.name,value:e.code})})),this.queryForm.jpcode&&this.search()},reSet:function(){var t=u()(new Date).format("YYYY-MM-DD 00:00:00"),e=new Date;this.timeArr=[t,e],this.queryForm.type="ePtp",this.queryForm.jpcode=this.defulteCode,this.queryForm.part="1m",this.search()},search:function(){this.queryForm.st=u()(this.timeArr[0]).format("YYYY-MM-DD HH:mm:ss"),this.queryForm.et=u()(this.timeArr[1]).format("YYYY-MM-DD HH:mm:ss"),"ePtp"===this.queryForm.type?(this.getPower(),this.showOne=1,this.lineCharData.name[0]="正向有功电量(kW)"):"cos"===this.queryForm.type?(this.getFactor(),this.showOne=2):"pamx"===this.queryForm.type&&(this.getMaxNeed(),this.showOne=0,this.lineCharData.name[0]="最大需量(kW)")},getPower:function(){var t=this,e=[];this.tableRows=e.concat(this.powerHead),"1d"===this.queryForm.part&&this.tableRows.push({fixed:"right",label:"详情",prop:"detail",width:90}),Object(l["e"])(this.queryForm).then((function(e){t.tQ=e.count.tQ?e.count.tQ:0,t.jQ=e.count.jQ?e.count.jQ:0,t.fQ=e.count.fQ?e.count.fQ:0,t.pQ=e.count.pQ?e.count.pQ:0,t.gQ=e.count.gQ?e.count.gQ:0;var a=e.jpoint.dbRate;t.total=e.list.length,t.allData=e.list.map((function(t){return t.time=u()(t.st).format("YYYY-MM-DD HH:mm")+"—"+u()(t.et).format("YYYY-MM-DD HH:mm"),t.st=u()(t.st).format("YYYY-MM-DD HH:mm"),t.stQ=(t.lEptp/a).toFixed(2),t.etQ=(t.mEptp/a).toFixed(2),t.kpName=e.jpoint.kpName,t.name=e.jpoint.name,t.dbRate=a,t})),t.setData()}))},getFactor:function(){var t=this;this.tableRows=this.factorHead,Object(l["c"])(this.queryForm).then((function(e){t.min=e.count.min,t.avg=e.count.avg,t.max=e.count.max,t.total=e.list.length,t.allData=e.list.map((function(t){return t.name=e.jpoint.name,t.kpName=e.jpoint.kpName,t.st=u()(t.st).format("YYYY-MM-DD HH:mm"),t})),t.setData()}))},getMaxNeed:function(){var t=this;this.tableRows=this.needHead,Object(l["d"])(this.queryForm).then((function(e){t.total=e.list.length,t.allData=e.list.map((function(t){return t.name=e.jpoint.name,t.kpName=e.jpoint.kpName,t.st=u()(t.st).format("YYYY-MM-DD HH:mm"),t})),t.setData()}))},setData:function(){var t=(this.pageNum-1)*this.pageSize,e=this.pageNum*this.pageSize;this.tableData=this.allData.filter((function(a,i){return t<=i&&i<e})),this.setChar(this.tableData)},changTable:function(){this.showChar=!1},changChar:function(){this.showChar=!0},setChar:function(t){var e=this;this.lineCharData.xAxis=[],this.lineCharData.yAxis=[],this.lineCharData.series=[],t&&t.map((function(t,a){0===a?e.lineCharData.xAxis.push(u()(t.st).format("YYYY-MM-DD HH:mm")):e.lineCharData.xAxis.push(u()(t.st).format("MM-DD HH:mm")),"ePtp"===e.queryForm.type?e.lineCharData.yAxis.push((t.mEptp-t.lEptp).toFixed(2)):"cos"===e.queryForm.type?e.lineCharData.yAxis.push(t.mCos):"pamx"===e.queryForm.type&&e.lineCharData.yAxis.push(t.mDmdmax)})),this.lineCharData.series.push({type:"ePtp"==this.queryForm.type?"bar":"line",smooth:!0,data:this.lineCharData.yAxis,barWidth:"ePtp"==this.queryForm.type?20:""})},handleSizeChange:function(t){this.pageSize=t,this.setData()},handleCurrentChange:function(t){this.pageNum=t,this.setData()},handlDetail:function(){var t=this;this.detailRows=this.powerHead;var e=Object.assign({},this.queryForm);e.part="1m",Object(l["e"])(e).then((function(e){t.dialogVisible=!0;var a=e.jpoint.dbRate;t.detailData=e.list.map((function(t){return t.time=u()(t.st).format("YYYY-MM-DD HH:mm")+"—"+u()(t.et).format("YYYY-MM-DD HH:mm"),t.st=u()(t.st).format("YYYY-MM-DD HH:mm"),t.stQ=(t.lEptp/a).toFixed(2),t.etQ=(t.mEptp/a).toFixed(2),t.kpName=e.jpoint.kpName,t.name=e.jpoint.name,t.dbRate=a,t}))}))},handleClose:function(){this.dialogVisible=!1},handDown:function(){var t=this;this.$confirm("是否确认下载电量报表","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){return Object(l["a"])(t.queryForm)})).then((function(t){c["a"].down(t)}))},exportDown:function(){var t=this,e=Object.assign({},this.queryForm);e.part="1m",this.$confirm("是否确认下载电量明细报表","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){return Object(l["a"])(e)})).then((function(e){c["a"].down(e),t.dialogVisible=!1})).catch((function(){t.dialogVisible=!1}))}},activated:function(){this.search()},deactivated:function(){this.tableData=[],this.lineCharData.series=[]}},h=m,f=(a("3da2"),a("2877")),b=Object(f["a"])(h,i,s,!1,null,"af31ec48",null);e["default"]=b.exports},f076:function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"e",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"d",(function(){return r})),a.d(e,"a",(function(){return l}));var i=a("b775");function s(t){return Object(i["c"])({method:"post",url:"count/zb",data:t})}function n(t){return Object(i["c"])({method:"post",url:"report/etcp",data:t})}function o(t){return Object(i["c"])({method:"post",url:"report/cos",data:t})}function r(t){return Object(i["c"])({method:"post",url:"report/pmax",data:t})}function l(t){return Object(i["c"])({method:"get",url:"export/report",params:t})}}}]);
//# sourceMappingURL=chunk-e3ccd112.790e1905.js.map